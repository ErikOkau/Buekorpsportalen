<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brukere</title>
    <link rel="stylesheet" href="../../../css/main.css">
    <link rel="stylesheet" href="../../../css/users.css">
    <link rel="stylesheet" href="../../../css/nav.css">
</head>

<body>
    <nav>
        <ul class="animated-nav">
            <li>
                <a href="../index.html" class="nav-link">Admin Dashboard</a>
            </li>
            <li>
                <a href="../users/foreldre.html" class="nav-link">Foreldre</a>
            </li>
            <li>
                <a href="../users/" class="nav-link">Brukere</a>
            </li>
            <li>
                <a href="../companies/" class="nav-link">Kompanier</a>
            </li>
            <li>
                <a href="/logout" id="logoutBtn" class="nav-link">Sign out</a>
            </li>
        </ul>
    </nav>
    <header>
        <h1>Liste over foreldre</h1>
    </header>
    <div class="tables">
        <div id="parentTable"></div>
    </div>
   
    <script>
    ['parent'].forEach(role => {
    fetch(`/showDB?role=${role}`)
        .then(response => response.json())
        .then(users => {
        const table = document.createElement('table');
        table.innerHTML = `
            <tr>
            <th>ID</th>
            <th>navn</th>
            <th>Etternavn</th>
            <th>Email</th>
            <th>Passord</th>
            <th>Rolle</th>
            <th>Barn</th>
            <th>Handlinger</th>
            </tr>
            ${users.map(user => `
            <tr>
                <td>${user.id}</td>
                <td>${user.name}</td>
                <td>${user.surname}</td>
                <td>${user.email}</td>
                <td>${user.password}</td>
                <td>${user.role}</td>
                <td>
                <button class="edit_btn" onclick="location.href='/editUser?id=${user.id}'">Edit</button>
                <button class="delete_btn" onclick="deleteUser(${user.id})">Delete</button>
                </td>
            </tr>
            `).join('')}
        `;
        document.getElementById(`${role}Table`).appendChild(table);
        });
    });
    
    function deleteUser(id) {
        if (confirm('Are you sure you want to delete this user?')) {
        fetch(`/deleteUser?id=${id}`, { method: 'DELETE' })
            .then(response => {
            if (response.ok) {
                location.reload();
            } else {
                alert('Error deleting user');
            }
            });
        }
    }
    </script>
</body>
</html>